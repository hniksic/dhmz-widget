<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DHMZ Vrijeme</title>

    <!-- PWA support -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Vrijeme">
    <meta name="theme-color" content="#1a1a2e">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="icon-192.png">

    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="widget refreshing" id="widget">
        <!-- Error state (hidden by default) -->
        <div class="error" id="error" hidden>
            <div class="error-icon">⚠️</div>
            <p id="error-message"></p>
            <button class="retry-btn" onclick="location.reload()">Pokušaj ponovo</button>
        </div>

        <!-- Loading/status state (hidden by default) -->
        <div class="status" id="status" hidden>
            <p id="status-message"></p>
            <button class="cancel-btn" id="status-cancel">Odustani</button>
        </div>

        <!-- Weather display (hidden until data loads) -->
        <div id="weather" hidden>
            <div class="header">
                <h1 id="title">Zagreb</h1>
            </div>

            <div class="temperature-display">
                <div class="temperature-value">
                    <span id="temperature"></span><span class="unit">°C</span>
                </div>
            </div>

            <div class="station-info">
                <span id="time"></span><span class="info-separator" id="station-subtitle" hidden> · <span id="subtitle-value"></span></span><span class="info-separator" id="distance-warning" hidden> · <span id="distance-value"></span> km</span>
            </div>

            <div class="weather-condition" id="condition-container">
                <span id="condition"></span>
            </div>

            <div class="details" id="details">
                <div class="detail-item empty" id="humidity-container">
                    <div class="detail-label">Vlažnost</div>
                    <div class="detail-value"><span id="humidity"></span>%</div>
                </div>
                <div class="detail-item empty" id="pressure-container">
                    <div class="detail-label">Tlak <span id="pressure-trend" class="trend"></span></div>
                    <!-- Unit intentionally omitted - value is obviously hPa -->
                    <div class="detail-value"><span id="pressure"></span></div>
                </div>
                <div class="detail-item empty" id="wind-container">
                    <div class="detail-label">Vjetar</div>
                    <div class="detail-value"><span id="wind"></span></div>
                </div>
            </div>
        </div>

        <div class="location-picker" id="location-picker">
            <button class="location-trigger" id="location-trigger" aria-label="Odaberi lokaciju" aria-haspopup="listbox">▾</button>
            <div class="location-dropdown" id="location-dropdown" role="listbox" hidden></div>
        </div>

    </div>

    <div class="map-modal" id="map-modal" hidden>
        <div class="map-container">
            <button class="map-close" id="map-close" aria-label="Zatvori kartu">✕</button>
            <!-- viewBox width is 610 * 0.85 ≈ 519 for latitude correction -->
            <svg id="station-map" viewBox="0 0 519 476" preserveAspectRatio="xMidYMid meet">
                <!-- Croatia outline path uses original 610×476 coordinates; JS applies scale(0.85, 1) -->
                <g id="croatia-outline">
                    <path d="M36.0 125.1L39.6 129.4L64.7 134.5L70.1 132.2L73.4 128.8L73.4 126.6L75.6 125.9L84.4 129.3L91.6 128.5L103.2 128.3L111.5 128.9L117.0 126.3L124.4 116.9L127.1 111.6L130.5 110.3L132.7 110.9L134.3 115.3L138.2 119.4L146.2 126.0L151.8 129.2L157.0 130.4L162.0 127.7L167.2 126.9L182.1 132.1L194.6 133.1L203.9 130.4L202.7 126.7L199.3 122.5L198.6 118.5L199.2 115.0L205.6 111.5L205.3 110.0L197.6 103.9L198.0 102.3L214.8 95.5L231.1 91.6L233.7 88.6L235.2 84.2L236.0 75.8L235.1 68.9L228.5 62.5L228.0 59.2L229.6 55.9L232.2 52.8L238.7 51.5L246.3 49.3L252.3 46.8L260.5 44.7L266.9 41.7L273.2 34.8L277.0 33.6L288.6 34.6L291.0 32.9L289.4 22.9L291.5 20.3L295.6 18.9L297.5 17.5L307.6 18.6L316.1 21.2L321.2 22.7L338.2 30.0L349.9 38.2L356.5 47.2L365.3 54.2L376.4 59.2L385.3 65.9L391.8 74.5L400.9 79.2L412.6 80.3L420.0 83.2L423.2 88.0L429.5 92.3L439.1 96.2L454.1 98.3L482.7 98.9L485.2 99.0L491.7 100.2L499.2 98.7L508.4 95.6L511.3 93.8L521.0 83.8L526.3 84.7L536.9 83.5L543.3 81.3L543.8 81.3L543.4 83.8L542.7 88.3L537.5 91.4L542.8 98.7L547.8 110.5L545.0 116.3L548.4 120.8L558.1 124.1L558.9 125.3L556.0 126.7L553.5 130.5L553.3 137.6L561.7 144.2L578.8 150.4L584.3 151.5L586.4 153.9L589.3 155.4L590.9 157.3L591.0 159.8L589.8 161.5L581.7 162.1L572.4 162.1L565.9 159.1L565.3 161.3L565.2 163.8L558.8 165.3L562.3 182.6L560.9 187.6L558.6 189.2L556.4 188.5L553.7 188.3L552.4 190.0L553.5 193.7L547.2 194.1L537.2 192.2L532.6 188.8L531.9 185.4L531.8 182.2L528.6 177.0L520.7 171.6L504.0 170.7L497.9 169.0L491.6 167.1L484.7 165.6L478.3 165.8L470.6 167.2L457.1 164.8L452.6 168.0L445.5 171.7L439.7 171.6L428.0 163.1L424.5 162.5L414.3 166.9L410.1 167.1L406.9 165.7L393.1 162.5L386.8 161.8L382.3 163.3L374.1 161.7L354.4 150.6L342.3 159.0L317.5 156.9L310.1 162.7L301.7 173.7L294.8 178.9L288.9 177.0L281.9 172.2L269.6 159.8L263.4 157.5L256.2 157.0L250.0 158.4L246.7 160.9L244.1 179.0L241.9 195.0L241.8 204.6L255.4 213.5L271.5 228.7L276.7 230.5L279.3 235.5L283.1 248.4L287.3 262.8L295.5 272.4L302.9 279.3L311.9 285.3L323.2 294.8L332.4 305.2L334.9 309.0L352.8 322.7L370.2 336.7L385.8 341.6L388.3 344.2L388.4 355.0L390.1 359.1L400.5 370.3L421.7 386.9L424.2 390.7L424.9 393.5L423.5 395.6L418.0 397.9L413.4 395.4L393.6 379.2L374.5 369.0L353.0 349.9L324.1 342.3L304.4 333.9L292.5 335.2L279.4 337.8L271.3 337.9L265.5 336.4L261.4 331.2L262.0 327.2L261.3 321.9L249.8 313.5L234.1 305.6L219.2 295.2L189.3 267.4L183.3 258.4L189.2 256.7L193.6 256.9L198.7 255.0L206.8 255.0L216.5 256.8L207.9 250.9L197.3 245.0L169.8 221.8L161.6 210.9L160.6 199.0L162.7 182.8L157.7 171.3L136.5 156.2L128.7 148.3L113.1 143.6L106.1 144.1L101.8 149.9L98.8 162.9L84.9 180.1L80.3 187.5L73.0 197.2L66.7 197.9L63.0 197.0L51.7 180.7L40.9 168.4L39.4 162.5L38.4 155.3L30.2 128.9L36.0 125.1Z M328.9 391.7L346.5 394.7L359.4 393.3L371.1 395.1L378.4 398.5L380.1 400.2L370.7 400.4L360.0 399.0L348.0 402.4L337.3 400.6L333.2 398.4L330.4 395.6L328.9 391.7Z M380.7 378.1L374.0 379.2L331.6 378.4L319.3 376.2L305.6 370.5L302.8 368.8L316.6 367.1L329.4 368.8L333.3 372.9L368.0 376.2L380.7 378.1Z M341.7 362.7L326.7 363.0L313.6 361.1L307.2 357.8L307.7 355.1L309.7 350.4L324.2 351.0L346.4 354.3L351.8 358.1L350.1 359.9L341.7 362.7Z M153.5 182.2L141.7 184.5L136.1 180.5L134.7 177.1L125.0 176.1L119.2 171.4L118.0 169.4L126.3 164.3L130.7 156.0L136.3 161.0L143.1 170.3L146.7 172.9L153.5 182.2Z M155.5 205.3L157.9 210.0L148.9 205.8L140.9 204.2L139.2 201.0L140.3 198.4L142.1 195.9L148.1 196.2L149.0 198.7L155.5 205.3Z M189.5 250.1L187.1 252.9L180.9 247.7L175.2 244.0L171.2 239.7L163.3 234.2L160.6 228.0L148.7 215.3L147.0 211.8L152.9 217.0L157.8 220.2L161.8 221.0L172.2 229.1L182.3 239.5L194.4 248.6L191.9 248.8L189.5 250.1Z M189.6 293.8L190.9 295.4L190.8 296.4L185.8 294.9L184.5 295.4L161.2 272.3L158.7 267.8L167.0 273.2L189.6 293.8Z M122.8 215.8L122.0 219.9L116.2 214.7L113.3 205.4L106.0 190.4L105.1 186.1L108.9 181.9L108.7 177.7L103.5 164.5L107.8 162.4L110.4 162.1L111.4 171.3L113.8 176.5L120.8 183.0L119.4 193.7L120.8 208.9L122.2 212.3L122.8 215.8Z M499.1 437.9L499.3 441.8L502.9 446.3L506.8 451.4L489.2 441.3L472.8 430.1L440.7 412.8L417.9 408.6L386.8 394.7L366.5 389.8L374.2 388.7L383.1 388.6L431.2 407.2L425.8 402.3L432.7 400.3L438.6 401.7L442.4 407.8L449.8 411.7L461.7 418.7L469.3 424.1L486.5 433.8L490.5 435.1L499.1 437.9Z"/>
                </g>
                <!-- Station dots will be added dynamically -->
                <g id="station-dots"></g>
                <!-- User location marker -->
                <g id="user-location"></g>
            </svg>
            <div class="map-tooltip" id="map-tooltip" hidden></div>
            <div class="station-label" id="station-label" hidden></div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
